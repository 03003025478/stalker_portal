var debug = false,
    iviURL =  'http://www.ivi.ru/mobileapi/',
    proxyURL = 'http://alu5.rl3u.owl.e.s3.hideme.ru/mobileapi/videofullinfo/?id=',
    win = {"width":screen.width,"height":screen.height},
    lang = '',
    layers = ['login_page','cats_page','subcats_page','search_page','content_page','player_page','genre_page','info_page'],
    layer_auth = 0,
    layer_cats = 1,
    layer_subcats = 2,
    layer_search = 3,
    layer_content = 4,
    layer_player = 5,
    layer_genre = 6,
    layer_info = 7,
    layer_conf = 8,
    layer_keyboard = 9,
    PREV_LAYER = [0],
    CUR_LAYER = 0,
    
    sub_layers = ['pop_layer','video_layer'],
    sub_layer_pop = 0,
    sub_layer_video = 1,
    SUB_CUR_LAYER = 0,
    left_side = true,
    pop_layer = true,
    layer_indexes = {
        "active":[
            {'login_form':0},0,0,0,0,0,0
        ],
        "array":[
            {'login_form':['login','password','submit','login_ok','login_cancel']},
            [],
            [],
            {'search_form':['search_line','search_cats','search_country','search_ok','search_cancel']},
            [],
            [],
            [{'genre_len':0}]
        ]
    },
    
	powerOff = false,
    autologin = false,
    promo_obj = [],
    cats_obj = [],
    dataset = [],
    seasons,
    reclama,
    advIsPlaying = false,
    secondadvwached = false,
    thirdadvwatched = false,
    current_series = 0,
    search_obj = [],
    subcatsArr = [],
    newAlert_on = false,
    year_focus = 0,
    //catsSelector = {"step":[0,0,234,0],position:[0,0,166,0]},
    suggest_active = false,
    suggest_count = 0,
    suggest_focus = -1,
    conf_focus = 1,
    vars={
        "sn":'',
        "catSel":0,
        "curCatSel":0,
        "catsArr":[
                    {"id":"cat_0","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"},
                    {"id":"cat_1","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"},
                    {"id":"cat_2","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"},
                    {"id":"cat_3","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"},
                    {"id":"cat_4","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"},
                    {"id":"cat_5","normal":"menu","focus":"menu_focus","click":"menu_act","func":"req"}],
        "catID":[14,14,15,17,16],
        "cats":[
            [{"id":null,"title":''},{"id":null,"title":''},{"year_from":null,"year_to":null}],
            [{"id":null,"title":''},{"id":null,"title":''},{"year_from":null,"year_to":null}],
            [{"id":null,"title":''},{"id":null,"title":''},{"year_from":null,"year_to":null}],
            [{"id":null,"title":''},{"id":null,"title":''},{"year_from":null,"year_to":null}]]
        ,
        "promo_page":0,
        "subcats_page":0,
        "subcats_item":0,
        "cont_page_x":0,
        "cont_page_y":0,
        "content_page":0,
        "player_vars":{
            "quarter":0,
            "timetostart":0,
            "volume":0,
            "mute":0,
            "playback":0,
            "playlist":0,
            "roller_step":0,
            "isplaying":0,
            "pause":false,
            "aspect_current":0,
            "aspects":[
                {
                    "name":"fit",
                    "img":'img/aspect_fit.png',
                    "mode":0x10
                },
                {
                    "name":"big",
                    "img":'img/aspect_big.png',
                    "mode":0x40
                },
                {
                    "name":"opt",
                    "img":'img/aspect_opt.png',
                    "mode":0x50
                },
                {
                    "name":"exp",
                    "img":'img/aspect_exp.png',
                    "mode":0x00
                }
            ],
        },
        "player_shown":false,
        "file_curtime":0,
        "file_lenght":0,
        "file_percent":0,
        
        
        "480":{
            "subcats_onpage":11,
            "cont_page_x_max":3,
            "cont_page_y_max":2,
            "poster_width":'122px',
            "poster_height":'176px',
            "infoposter_width":'114px',
            "infoposter_height":'176px',
            "promo_width":'',
            "promo_height":'',
            "stripe_len":560,
        },
        "576":{
            "subcats_onpage":11,
            "cont_page_x_max":3,
            "cont_page_y_max":2,
            "poster_width":'122px',
            "poster_height":'176px',
            "infoposter_width":'172px',
            "infoposter_height":'264px',
            "promo_width":'',
            "promo_height":'',
            "stripe_len":560,
        },
        "720":{
            "subcats_onpage":11,
            "cont_page_x_max":4,
            "cont_page_y_max":2,
            "poster_width":'172px',
            "poster_height":'264px',
            "infoposter_width":'344px',
            "infoposter_height":'528px',
            "promo_width":'',
            "promo_height":'',
            "stripe_len":1120,
        },
        "1080":{
            "subcats_onpage":11,
            "cont_page_x_max":4,
            "cont_page_y_max":2,
            "poster_width":'288px',
            "poster_height":'416px',
            "infoposter_width":'516px',
            "infoposter_height":'792px',
            "promo_width":'',
            "promo_height":'',
            "stripe_len":1760,
        }
    }; 
    var fileTyps = ['MP4-low-mobile','MP4-mobile','MP4-lo','FLV-hi','MP4-hi'];
    //Алфавит
    
    var alphabet = [
        [{"text":"а","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"б","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"в","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"г","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"д","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"е","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ё","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"1","clas_act":"keypad_key_act keypad_empty","clas":"keypad_key keypad_empty"},{"text":"2","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"3","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ж","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"з","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"и","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"й","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"к","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"л","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"м","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"4","clas_act":"keypad_key_act keypad_empty","clas":"keypad_key keypad_empty"},{"text":"5","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"6","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"н","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"о","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"п","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"р","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"с","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"т","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"у","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"7","clas_act":"keypad_key_act keypad_empty","clas":"keypad_key keypad_empty"},{"text":"8","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"9","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ф","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"х","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ц","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ч","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ш","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"щ","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ь","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"","clas_act":"keypad_key_null keypad_empty","clas":"keypad_key_null keypad_empty"},{"text":"0","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"","clas_act":"keypad_key_null","clas":"keypad_key_null"},{"text":"ы","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ъ","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"э","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"ю","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"я","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":".","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"<img src='img/keypad_space.png' />","clas_act":"keypad_key_act","clas":"keypad_key"},{"text":"<img src='img/keypad_left.png' />","clas_act":"keypad_key_red_act keypad_empty","clas":"keypad_key_red keypad_empty"},{"text":"<img src='img/keypad_right.png' />","clas_act":"keypad_key_green_act","clas":"keypad_key_green"},{"text":"<img src='img/keypad_bs.png' />","clas_act":"keypad_key_yellow_act","clas":"keypad_key_yellow"}]
    ],
    keyboard_idx = 0;
    
    //Таймера
    var runner_timer = null,
        pos_timer = null,
        setpos_timer = null,
        set_volume = null,
        adv_timer = null;
    
    var genres = {
            94:"боевик",
            95:"комедия",
            97:"детектив",
            99:"ужасы",
            101:"приключения",
            103:"военный",
            105:"драма",
            107:"мелодрама",
            109:"документальный",
            127:"триллер",
            123:"детские",
            124:"взрослые",
            125:"аниме",
            111:"юмористические",
            112:"гламур",
            113:"авто-мото",
            114:"психология и гороскопы",
            116:"дом и сад",
            117:"вокруг света",
            118:"охота и рыбалка",
            119:"познавательные",
            120:"красота и здоровье",
            121:"новый год",
            122:"спорт",
            126:"воспитательный",
            130:"кулинария",
            93:"боевик",
            96:"детектив",
            98:"ужасы",
            100:"приключения",
            102:"военный",
            104:"драма",
            106:"мелодрама",
            108:"документальный",
            110:"комедийный",
            128:"триллер",
            160:"детский",
            161:"авторское кино",
            163:"классика",
            166:"фантастика",
            167:"короткометражка",
            168:"советский",
            169:"эротика",
            170:"полнометражный",
            172:"советский",
    }
    var countries = {
        "1": "\u0420\u043e\u0441\u0441\u0438\u044f", 
        "2": "\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c", 
        "3": "\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e", 
        "4": "\u0421\u0428\u0410", 
        "5": "\u041d\u043e\u0432\u0430\u044f \u0417\u0435\u043b\u0430\u043d\u0434\u0438\u044f", 
        "6": "\u0412\u0435\u043b\u0438\u043a\u043e\u0431\u0440\u0438\u0442\u0430\u043d\u0438\u044f", 
        "8": "\u0424\u0440\u0430\u043d\u0446\u0438\u044f", 
        "10": "\u0428\u0432\u0435\u0439\u0446\u0430\u0440\u0438\u044f", 
        "12": "\u041a\u0438\u0442\u0430\u0439", 
        "13": "\u0422\u0430\u0439\u043b\u0430\u043d\u0434", 
        "15": "\u041a\u0430\u043d\u0430\u0434\u0430", 
        "16": "\u0410\u0432\u0441\u0442\u0440\u0430\u043b\u0438\u044f", 
        "17": "\u041f\u043e\u043b\u044c\u0448\u0430", 
        "18": "\u0414\u0430\u043d\u0438\u044f", 
        "19": "\u042e\u0410\u0420", 
        "20": "\u042f\u043f\u043e\u043d\u0438\u044f", 
        "21": "\u041d\u0438\u0434\u0435\u0440\u043b\u0430\u043d\u0434\u044b", 
        "22": "\u041a\u0430\u0437\u0430\u0445\u0441\u0442\u0430\u043d", 
        "23": "\u0413\u043e\u043d\u043a\u043e\u043d\u0433", 
        "24": "\u0413\u0435\u0440\u043c\u0430\u043d\u0438\u044f", 
        "25": "\u042e\u0436\u043d\u0430\u044f \u041a\u043e\u0440\u0435\u044f", 
        "26": "\u0421\u041d\u0413", 
        "27": "\u0410\u0432\u0441\u0442\u0440\u0438\u044f", 
        "28": "\u0418\u0440\u043b\u0430\u043d\u0434\u0438\u044f", 
        "29": "\u0418\u0442\u0430\u043b\u0438\u044f", 
        "30": "\u0420\u0443\u043c\u044b\u043d\u0438\u044f", 
        "31": "\u041c\u0435\u043a\u0441\u0438\u043a\u0430", 
        "32": "\u0422\u0443\u0440\u0446\u0438\u044f", 
        "33": "\u0423\u043a\u0440\u0430\u0438\u043d\u0430", 
        "34": "\u0410\u0437\u0435\u0440\u0431\u0430\u0439\u0434\u0436\u0430\u043d", 
        "35": "\u0410\u0440\u043c\u0435\u043d\u0438\u044f", 
        "36": "\u0421\u043b\u043e\u0432\u0430\u043a\u0438\u044f", 
        "37": "\u0413\u0440\u0443\u0437\u0438\u044f", 
        "38": "\u041a\u0438\u0440\u0433\u0438\u0437\u0438\u044f", 
        "39": "\u0422\u0430\u0434\u0436\u0438\u043a\u0438\u0441\u0442\u0430\u043d", 
        "40": "\u0422\u0443\u0440\u043a\u043c\u0435\u043d\u0438\u0441\u0442\u0430\u043d", 
        "41": "\u0423\u0437\u0431\u0435\u043a\u0438\u0441\u0442\u0430\u043d", 
        "42": "\u041c\u043e\u043b\u0434\u043e\u0432\u0430", 
        "43": "\u0412\u0435\u0441\u044c \u041c\u0438\u0440", 
        "44": "\u041b\u0430\u0442\u0432\u0438\u044f", 
        "45": "\u042d\u0441\u0442\u043e\u043d\u0438\u044f", 
        "46": "\u041b\u0438\u0442\u0432\u0430", 
        "48": "\u0418\u0441\u043f\u0430\u043d\u0438\u044f", 
        "49": "\u0428\u0432\u0435\u0446\u0438\u044f", 
        "50": "\u041a\u043e\u043b\u0443\u043c\u0431\u0438\u044f", 
        "51": "\u0418\u0441\u043b\u0430\u043d\u0434\u0438\u044f", 
        "52": "\u0410\u0440\u0433\u0435\u043d\u0442\u0438\u043d\u0430", 
        "54": "\u0424\u0438\u043d\u043b\u044f\u043d\u0434\u0438\u044f", 
        "55": "\u041d\u043e\u0440\u0432\u0435\u0433\u0438\u044f", 
        "56": "\u0418\u043d\u0434\u0438\u044f", 
        "57": "\u0413\u0440\u0435\u0446\u0438\u044f", 
        "58": "\u0427\u0435\u0445\u0438\u044f", 
        "59": "\u0411\u0440\u0430\u0437\u0438\u043b\u0438\u044f", 
        "60": "\u0411\u0435\u043b\u044c\u0433\u0438\u044f", 
        "61": "\u041f\u043e\u0440\u0442\u0443\u0433\u0430\u043b\u0438\u044f", 
        "62": "\u0412\u0435\u043d\u0433\u0440\u0438\u044f", 
        "63": "\u0418\u043d\u0434\u043e\u043d\u0435\u0437\u0438\u044f", 
        "67": "\u0418\u0440\u0430\u043d", 
        "69": "\u041b\u0438\u0432\u0430\u043d", 
        "70": "\u041f\u0443\u044d\u0440\u0442\u043e-\u0420\u0438\u043a\u043e", 
        "71": "\u0418\u0437\u0440\u0430\u0438\u043b\u044c"
    }