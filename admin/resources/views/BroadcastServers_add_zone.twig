{% extends 'layout.twig' %}
{% set title = 'streams' %}

{% block content %}
    <div id="add_channel">
        {{ form_start(app['form'], {'method': 'POST', 'action': (app.request.baseUrl ~ '/' ~ app.controller_alias  ~ '/' ~ app.action_alias) | trans, 'attr': {'class': 'form-horizontal', 'role': 'form', 'id': 'form_'}}) }}
        <div class="bg-danger">
            <div class="bg-danger">
                {{ form_errors(app['form']) }}
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="box">
                    <div class="box-content">
                        <div class="form-group">
                            <label class="col-sm-2 control-label col-xs-offset-1">Внешний ID</label>
                            <div class="col-xs-10 col-sm-6">
                                <div class=" col-xs-10 col-sm-6">
                                    {{ form_widget(app['form'].id, {'attr': {'class': 'form-control'}}) }}
                                    {{ form_widget(app['form'].name, {'attr': {'class': 'form-control'}}) }}
                                    <div class="bg-danger">
                                        {{ form_errors(app['form'].name) }}
                                    </div>
                                    <span class="help-inline col-xs-12 col-sm-12">
                                        <span class="small txt-default">Условное название зоны. Можно использовать буквы, цифры и символы из списка: ! @ # $ % ^ & * ( ) _ - + : ; , .</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label col-xs-offset-1">Зона по умолчанию</label>
                            <div class="col-xs-10 col-sm-6">
                                <div class=" col-xs-10 col-sm-6">
                                    <div class="checkbox">
                                        <label>
                                            {{ form_widget(app['form'].default_zone) }}      
                                            <i class="fa fa-square-o small"></i>
                                        </label>
                                        <div class="bg-danger">
                                            {{ form_errors(app['form'].default_zone) }}
                                        </div>
                                    </div>
                                    <span class="help-inline col-xs-12 col-sm-12">
                                        <span class="small txt-default">Будет выбрана стартовой для всех новых серверов вещания у которых не указана зона</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label col-xs-offset-1">&nbsp;</label>
                            <div class="col-xs-10 col-sm-6">
                                <fieldset id="letters" class=" col-xs-10 col-sm-12">
                                    <div class=" col-xs-10 col-sm-5">
                                        <label class="col-sm-12 control-label">Страны</label>
                                        {{ form_widget(app['form'].disabled_countries, {'attr': {'class': 'left populate placeholder col-sm-12', "multiple": "multiple"}}) }}
                                        <div class="bg-danger">
                                            {{ form_errors(app['form'].disabled_countries) }}
                                        </div>
                                    </div>
                                    <div class=" col-xs-10 col-sm-2">
                                        <br><br><br><br><br>
                                        <button type="button" class="add all btn btn-block btn-default"> все &gt;&gt; </button>
                                        <button type="button" class="add btn btn-block btn-default"> &gt; </button>
                                        <button type="button" class="remove btn btn-block btn-default"> &lt; </button>
                                        <button type="button" class="remove all btn btn-block btn-default"> &lt;&lt; все</button>
                                    </div>
                                    <div class=" col-xs-10 col-sm-5">
                                        <label class="col-sm-12 control-label">Выбрано</label>
                                        {{ form_widget(app['form'].countries, {'attr': {'class': 'right populate placeholder col-sm-12', "multiple": "multiple"}}) }}
                                        <div class="bg-danger">
                                            {{ form_errors(app['form'].countries) }}
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                        </div>    
                    </div>
                </div>
                <div class="box">
                    <div class="box-content">
                        <div class="row">
                            <div class="col-xs-10 col-sm-4 pull-right">
                                {{ form_widget(app['form'].save, { 'label': 'Сохранить' , attr: {'class': 'btn btn-success col-sm-5 pull-right'}}) }}
                                <a href="{{app.request.baseUrl}}/{{app.controller_alias}}/broadcast-zone-list" class="btn btn-default col-sm-5 pull-left">Отмена</a>
{#                                {{ form_widget(app['form'].reset, { 'label': 'Отмена' , attr: {'class': 'btn btn-default col-sm-5 pull-left'}}) }}#}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div style="">
            {#{{ form_widget(app.form._token) }}#}
            {{ form_rest(app.form) }}
        </div>
        {{ form_end(app['form']) }}  
    </div>
    <script type="text/javascript" defer>
               
        function yelp() {
            $(document).ready(function () {
                $('head').append('<link href="{{ app.request.baseUrl }}/plugins/multiselect_transfer/style.css" type="text/css" rel="stylesheet" />');

                if ($('#form_default_zone').val() == 1){
                    $('#form_default_zone').attr('checked', 'checked');
                } 
                
                $(document).on('click', '#form_save', function(){
                var sendData =[];
                    $('#form_disabled_countries').find('option').each(function(index, val){
                        var _val = $(this);
                        if (_val.val()) {
                            sendData.push(_val.val());
                        }
                    });
                    $('#form_disabled_countries_json').val(JSON.stringify(sendData));
                var sendData =[];    
                    $('#form_countries').find('option').each(function(index, val){
                        var _val = $(this);
                        if (_val.val()) {
                            sendData.push(_val.val());
                        }
                    });
                    $('#form_countries_json').val(JSON.stringify(sendData));
                });
            });
        }
        document.addEventListener("DOMContentLoaded", yelp, false);

    </script>
{% endblock %}